<html>
<body>
<head>
 <link rel="stylesheet" type="text/css" href="pages.css">
 <link rel="stylesheet" type="text/css" href="morecities.css">


  <link href="https://fonts.googleapis.com/css?family=Lobster" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Amatic+SC" rel="stylesheet">
</head>
 <body>
      <nav>
        <ul>
          <li><a href="index.html">Home</a></li>
          <li><a href="home.html">Compare Culture</a></li>
          <li><a href="morecities.html">Try more cities</a></li>
          <li><a href="contact.html">Maps</a></li>
          <li><a href="about.html">About Us</a></li>
       </ul>
      </nav>

     <div id="content">
      
       
      <div id ="bosC">
        <div class = "dropdown">
          <div id="city1" class="dropbtn" onclick="drop1()">City 1</div>
            <div id="myDropdown1" class="dropdown-content">
              <p id="newport1" style="">Newport,RI</p>
              <p id="seattle1" style="">Seattle,WA</p>
              <p id="portsmouth1" style="">Portsmouth,NH</p>
              <p id="miami1" style="">Miami,FL</p>
            </div>
        </div>
        <br>
        <div id ="bos" style="display:none"></div> 
        <span class="titleAxis" style="display:none" id="axisB"> <p>Amount</p> </span>
      </div>
      <div id ="arr"> <img src="img/arrow_down.png" class="bounce" id="arrow"> </div>
      <div id ="houC">
        <div class = "dropdown">
          <div id="city2" class="dropbtn" onclick="drop2()">City 2</div>
            <div id="myDropdown2" class="dropdown-content">
              <p id="newport2" style="">Newport,RI</p>
              <p id="seattle2" style="">Seattle,WA</p>
              <p id="portsmouth2" style="">Portsmouth,NH</p>
              <p id="miami2" style="">Miami,FL</p>
            </div>
        </div>
        <br>
        <div id ="hou" style="display:none"></div> 
        <span class="titleAxis" style="display:none" id="axisH"> <p>Amount</p> </span>
      </div>

     </div>

    
    
    </div>

<script src="https://d3js.org/d3.v4.min.js"></script>
<script>

var activeLeft = '';
var activeRight = '';

var inactiveLeft = '';
var inactiveRight = '';

var axisB = document.getElementById('axisB');
var axisH = document.getElementById('axisH');

var arr = document.getElementById('arr');
var boston = document.getElementById('bos');
var houston = document.getElementById('hou');
var bounce = document.getElementsByClassName('bounce');
var city1 = document.getElementById('city1');
var city2 = document.getElementById('city2');
var el_drop1 = document.getElementById('myDropdown1');
var el_drop2 = document.getElementById('myDropdown2');
var newport1 = document.getElementById('newport1');
var newport2 = document.getElementById('newport2');
var seattle1 = document.getElementById('seattle1');
var seattle2 = document.getElementById('seattle2');
var portsmouth1 = document.getElementById('portsmouth1');
var portsmouth2 = document.getElementById('portsmouth2');
var miami1 = document.getElementById('miami1');
var miami2 = document.getElementById('miami2');
var content = document.getElementById('content');


var toggleArr = 0;

/** When clicked it will reveal the graphs */
arrow.addEventListener('click', function(){
  var cityL = city1.innerText;
  var cityR = city2.innerText;
  
  if(cityL !== "City 1" && cityR !== "City 2"){

    boston.style = "display:block";
    houston.style = "display:block";
    axisH.style = "display:block";
    axisB.style = "display:block";
    bounce[0].style.webkitAnimationPlayState="paused";
    arrow.style.float = 'left';
    arrow.style.cursor = 'auto';
  }

});

/* When the user clicks on the button, 
toggle between hiding and showing the dropdown content */
function drop1() {
    document.getElementById("myDropdown1").classList.toggle("show");
}

function drop2() {
    document.getElementById("myDropdown2").classList.toggle("show");
}

function hideCities(inactive){
  console.log(inactive)
  switch(inactive){
    case 'newport1':
      newport1.style = "display:block"
      break;
    case 'newport2':
      newport2.style = "display:block"
      break;
    case 'seattle1':
      seattle1.style = "display:block"
      break;
    case 'seattle2':
      seattle2.style = "display:block"
      break;
    case 'portsmouth1':
      portsmouth1.style = "display:block"
      break;
    case 'portsmouth2':
      portsmouth2.style = "display:block"
      break;
    case 'miami1':
      miami1.style = "display:block"
      break;
    case 'miami2':
      miami2.style = "display:block"
      break;
  }
}

newport1.addEventListener('click', function(){
  document.getElementById('bos').innerHTML = ""
  city1.innerText = 'Newport, RI'
  hideCities(inactiveRight)
  inactiveRight = 'newport2';
  newport2.style = "display:none"; 
  makeGet('/graph1/Newport,RI', '#bos')
});
newport2.addEventListener('click', function(){
  document.getElementById('hou').innerHTML = ""
  city2.innerText = 'Newport, RI'
  hideCities(inactiveLeft)
  inactiveLeft = 'newport1';
  newport1.style = "display:none"; 
  makeGet('/graph2/Newport,RI', '#hou')
});
seattle1.addEventListener('click', function(){
  document.getElementById('bos').innerHTML = ""
  city1.innerText = 'Seattle, WA'
  hideCities(inactiveRight)
  inactiveRight = 'seattle2';
  seattle2.style = "display:none";


  makeGet('/graph1/Seattle,WA', '#bos')
});
seattle2.addEventListener('click', function(){
  document.getElementById('hou').innerHTML = ""
  city2.innerText = 'Seattle, WA'
  hideCities(inactiveLeft)
  inactiveLeft = 'seattle1';
  seattle1.style = "display:none"; 
  makeGet('/graph2/Seattle,WA', '#hou')
});
portsmouth1.addEventListener('click', function(){
  document.getElementById('bos').innerHTML = ""
  city1.innerText = 'Portsmouth, NH'
  hideCities(inactiveRight)
  inactiveRight = 'portsmouth2';
  portsmouth2.style = "display:none";
  makeGet('/graph1/Portsmouth,NH', '#bos')
});
portsmouth2.addEventListener('click', function(){
  document.getElementById('hou').innerHTML = ""
  city2.innerText = 'Portsmouth, NH'
  hideCities(inactiveLeft)
  inactiveLeft = 'portsmouth1';
  portsmouth1.style = "display:none"; 
  makeGet('/graph2/Portsmouth,NH', '#hou')
});
miami1.addEventListener('click', function(){
  document.getElementById('bos').innerHTML = ""
  city1.innerText = 'Miami, FL'
  hideCities(inactiveRight)
  inactiveRight = 'miami2';
  miami2.style = "display:none";

  makeGet('/graph1/Miami,FL', '#bos')
});
miami2.addEventListener('click', function(){
  document.getElementById('hou').innerHTML = ""
  city2.innerText = 'Miami, FL'
  hideCities(inactiveLeft)
  inactiveLeft = 'miami1';
  miami1.style = "display:none"; 
  makeGet('/graph2/Miami,FL', '#hou')
});

// Close the dropdown menu if the user clicks outside of it
window.onclick = function(event) {
  if (!event.target.matches('.dropbtn')) {

    var dropdowns = document.getElementsByClassName("dropdown-content");
    var i;
    for (i = 0; i < dropdowns.length; i++) {
      var openDropdown = dropdowns[i];
      if (openDropdown.classList.contains('show')) {
        openDropdown.classList.remove('show');
      }
    }
  }
}

function makeGet(url, contName) {
  var req = new XMLHttpRequest();

  req.onreadystatechange = function() {
    handleRes(req, contName);
  }

  req.open('GET', url);
  req.send();
}

function handleRes(req, contName) {

  if( req.readyState !== XMLHttpRequest.DONE )
    return;

  if(req.status === 200){
    console.log(req.responseText)
    buildList( JSON.parse(req.responseText), contName);
  }
}

function buildList( A, contName ) {
console.log(A)
A.sort(function (a, b) {
  if (a.value < b.value) {
    return 1;
  }
  if (a.value > b.value) {
    return -1;
  }
  // a must be equal to b
  return 0;
});

  // A.sort();
  var data = A;
  var s = d3.scaleLinear()
          .domain([1,40])
          .range([0,400]);

  var a = d3.axisBottom(s);
       d3.select(contName).selectAll('p')
      .data(data)
      .enter().append('p')
      .text(function(d) { return d.key; }).style('text-align', 'left')
      .on('mouseenter', function() {
        d3.select(this).transition().duration(5000).style('width', function(d) { return d.value*10+'px'; }).style('color', 'white').style('background-color', '#936446')
      })



 var access = d3.select(contName).append('svg').attr('width', '145%').attr('height', 20);
  a(access);
}

  

</script>

</body>
</html>